<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>ì•”í˜¸í™”í ì˜¬ì¸ì› ê³„ì‚°ê¸° (ëª¨ë°”ì¼ ì´ˆì••ì¶• + ë¹„êµí‘œ ë²„íŠ¼ ì´ë™)</title>
<meta name="description" content="ìˆ˜ìˆ˜ë£Œ/PNL/í‰ë‹¨/ì²­ì‚°ê°€ ê³„ì‚°ê¸° + ê±°ë˜ì†Œ í˜œíƒ ë¹„êµ. ëª¨ë°”ì¼ì—ì„  ì´ˆì••ì¶• ë ˆì´ì•„ì›ƒ.">
<link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
<style>
:root{ --bg:#f7f7fb; --fg:#111827; --muted:#374151; --line:#e5e7eb; --accent:#2563eb; font-size:17px }
@media (min-width:900px){ :root{ font-size:18px } }
*{ box-sizing:border-box } html{ -webkit-text-size-adjust:100% }
body{ margin:0; background:var(--bg); color:var(--fg); font-family:"Pretendard",system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans KR",sans-serif; line-height:1.65; word-break:keep-all }
a{ color:var(--accent); text-decoration:none }
.wrap{ max-width:1120px; margin:0 auto; padding:24px 24px 96px }
h1{ margin:0 0 8px } h1,.btn,.section-title{ white-space:nowrap }
.lead{ margin:0 0 18px; color:var(--muted); font-size:1rem }
.topbar{ position:sticky; top:0; z-index:40; backdrop-filter:saturate(140%) blur(6px); background:rgba(247,247,251,.9); display:flex; align-items:center; gap:12px; flex-wrap:wrap; padding:10px 0 12px; border-bottom:1px solid var(--line) } .spacer{ flex:1 }
.btn{ display:inline-flex; align-items:center; justify-content:center; gap:8px; padding:10px 14px; border-radius:12px; border:1px solid var(--line); background:#fff; cursor:pointer; font-weight:900; min-height:44px }
.card{ background:#fff; border:1px solid var(--line); border-radius:20px; padding:18px 20px; margin-top:16px }
.section-title{ margin:0 0 12px; font-weight:900; font-size:1.125rem } @media(min-width:900px){ .section-title{ font-size:1.25rem } }
label{ display:block; font-size:0.95rem; margin:8px 0 6px; font-weight:700 }
input,select,button{ font-size:1rem }
input,select{ width:100%; padding:12px 14px; border:1px solid var(--line); border-radius:14px; background:#fff; min-height:44px }
.row{ display:flex; gap:10px; flex-wrap:wrap } .row>*{ flex:1 1 200px }
.col-3{ display:grid; gap:10px; grid-template-columns:1fr; } @media(min-width:900px){ .col-3{ grid-template-columns:1.15fr 1fr 1fr } }
.hidden{ display:none !important }

/* íƒ­ */
.tabs{ position:sticky; top:58px; z-index:30; display:flex; gap:8px; flex-wrap:nowrap; margin:6px 0 0; padding:10px 0; background:rgba(247,247,251,.95); border-bottom:1px solid var(--line); overflow-x:auto }
.tab-btn{ flex:0 0 auto; padding:10px 14px; border:1px solid var(--line); border-radius:14px; background:#fff; font-weight:800; cursor:pointer; min-height:40px }
.tab-btn.active{ background:#111827; color:#fff }
.tab-panel{ display:none !important } .tab-panel.active{ display:block !important; animation:fadeIn .24s ease }
.tab-panel.flexcol.active{ display:flex !important; flex-direction:column }
.seg{ display:flex; gap:8px } .seg button{ flex:1; padding:12px; border:1px solid var(--line); background:#fff; border-radius:14px; cursor:pointer; font-weight:800; min-height:44px } .seg button.active{ background:#111827; color:#fff; border-color:#111827 }
@keyframes fadeIn{ from{ opacity:0; transform:translateY(6px) } to{ opacity:1; transform:none } }

/* ë¦¬ìŠ¤íŠ¸/í‘œ */
.kv{ display:flex; justify-content:space-between; align-items:center; padding:8px 0 }
.kv .k{ font-weight:800 } .kv .v{ font-weight:900; font-variant-numeric:tabular-nums }
.result-box{ border:1px dashed var(--line); border-radius:14px; padding:12px; background:#fafafa }
.hr{ height:1px; background:var(--line); margin:6px 0 }
.actions-center{ display:flex; justify-content:center; align-items:center; gap:10px; margin-top:10px; flex-wrap:wrap }
.cta-main{ display:inline-flex; align-items:center; justify-content:center; border:0; border-radius:14px; padding:14px 16px; font-weight:900; color:#fff; text-decoration:none; width:100%; max-width:320px; min-height:48px; background:linear-gradient(90deg,#0ea5e9,#6366f1) }
.ref-box{ border:1px solid var(--line); border-radius:14px; padding:12px; background:#fcfcff }
.ref-grid{ display:grid; grid-template-columns:1fr 1fr; gap:8px }
.small{ color:#6b7280; font-size:.9rem }

/* ë°°ë„ˆ/í‘œ */
.banner{ position:relative; display:flex; flex-direction:column; gap:12px; color:#fff; border-radius:22px; padding:18px 20px; margin:0 0 12px; overflow:hidden; background-clip:padding-box; border:0; box-shadow:inset 0 0 0 1px rgba(255,255,255,.12), 0 10px 22px rgba(2,8,20,.06) }
.banner-header{ display:flex; gap:12px; align-items:center }
.banner img{ width:44px; height:44px; object-fit:contain; background:rgba(255,255,255,.16); border-radius:12px; padding:6px }
.banner h3{ margin:0; font-size:18px }
.banner p{ margin:4px 0 0; font-size:15px; display:flex; flex-wrap:wrap; gap:6px }
.badge{ display:inline-block; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.35); font-weight:900; white-space:nowrap }
.banner .cta-row{ display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin-top:6px }
.cta-white{ padding:11px 14px; border-radius:14px; background:#fff; color:#var(--brand); font-weight:900; text-decoration:none; border:1px solid rgba(0,0,0,.06) }
.ex-Bitget{ --brand:#0ea5e9 } .ex-Bybit{ --brand:#d97706 } .ex-OKX{ --brand:#0b0f19 } .ex-MEXC{ --brand:#10b981 } .ex-Binance{ --brand:#f0b90b } .ex-BingX{ --brand:#2563eb }
.table{ width:100%; border-collapse:separate; border-spacing:0; border:1px solid var(--line); border-radius:12px; overflow:hidden }
.table th,.table td{ padding:12px 14px; border-bottom:1px solid var(--line); text-align:left }
.table th{ background:#f9fafb; font-weight:900 } .table tr:last-child td{ border-bottom:0 }
.pill{ display:inline-block; padding:4px 10px; border-radius:999px; background:#eef2ff; color:#3730a3; font-weight:800; font-size:12px; border:1px solid #c7d2fe }

/* ëª¨ë‹¬ */
.modal-backdrop{ position:fixed; inset:0; background:rgba(15,23,42,.58); display:none; align-items:center; justify-content:center; z-index:60 }
.modal{ width:min(92vw,600px); background:#fff; border:1px solid var(--line); border-radius:16px; padding:16px; position:relative }
.modal-cta{ border:0; border-radius:12px; padding:11px 14px; font-weight:900; color:#fff; text-decoration:none; text-align:center }
.modal-close-x{ position:absolute; right:10px; top:10px; border:0; background:#fff; border:1px solid var(--line); border-radius:8px; font-size:18px; font-weight:900; cursor:pointer; line-height:1; width:32px; height:32px }
.chips{ display:flex; flex-wrap:wrap; gap:6px; justify-content:center; margin:6px 0 8px }
.chip{ padding:6px 10px; border-radius:999px; border:1px solid #e2e8f0; background:#f8fafc; font-weight:900; font-size:.92rem }

/* ëª¨ë°”ì¼ ì´ˆì••ì¶• ëª¨ë“œ */

@media (max-width:480px){
  :root{ font-size:14px }
  .wrap{ padding:10px 8px 84px }
  .card{ border-radius:12px; padding:8px 10px; margin-top:8px }
  .row{ gap:4px }
  input,select{ min-height:34px; padding:6px 8px; font-size:.9rem }
  .seg button{ min-height:34px; padding:6px 8px; font-size:.9rem }
  .tab-btn{ min-height:36px; padding:8px 10px; font-size:.9rem }
  .section-title{ font-size:1rem }
  .ref-box{ padding:8px }
  .result-box{ padding:8px }
  .kv{ font-size:.9rem }
  /* ê¸°ë³¸ì„¤ì • ì²«ì¤„ 2ì—´ ë°°ì¹˜ */
  #fee-config .row>div{ flex:1 1 48% }
  /* ì²´ê²°ê°€ì¹˜/ìˆ˜ìˆ˜ë£Œìœ¨/ì°¸ê³  ìˆ˜ìˆ˜ë£Œ 2ì—´ ê·¸ë¦¬ë“œ */
  .col-3{ grid-template-columns:1fr 1fr; gap:8px }
}

  .card{ border-radius:14px; padding:12px 12px; margin-top:10px }
  .row{ gap:6px }
  input,select{ min-height:36px; padding:8px 10px }
  .seg button{ min-height:36px; padding:8px 10px }
  .section-title{ font-size:1.05rem }
  .ref-box{ padding:10px }
  .result-box{ padding:10px }
  #fee-config .card{ padding:10px }
  .col-3{ gap:8px }
}

/* í•˜ë‹¨ ë„¤ë¹„(4ê°œ) */
.mobile-dock{ position:fixed; bottom:12px; left:50%; transform:translateX(-50%); z-index:50; width:min(94vw,620px); display:grid; grid-template-columns:repeat(4,1fr); gap:8px; background:rgba(255,255,255,.9); border:1px solid var(--line); border-radius:14px; padding:8px; box-shadow:0 8px 30px rgba(0,0,0,.08) }
.mobile-dock .dock-btn{ border:1px solid var(--line); background:#fff; border-radius:12px; padding:10px 8px; font-weight:900; text-align:center; cursor:pointer }
@media (min-width:901px){ .mobile-dock{ display:none } }

@media (max-width:480px){
  :root{ font-size:14px }
  .wrap{ padding:10px 8px 84px }
  .card{ border-radius:12px; padding:8px 10px; margin-top:8px }
  .row{ gap:6px }
  input,select{ min-height:34px; padding:6px 8px; font-size:.9rem }
  .seg button{ min-height:34px; padding:6px 8px; font-size:.9rem }
  .tab-btn{ min-height:36px; padding:8px 10px; font-size:.9rem }
  .section-title{ font-size:1rem }
  .ref-box{ padding:8px }
  .result-box{ padding:8px }
  .kv{ font-size:.9rem }

  /* ëª¨ë°”ì¼ì—ì„œëŠ” ì•ˆì „í•˜ê²Œ 1ì—´ (ì˜ë¦¼ ë°©ì§€) */
  .col-3{ grid-template-columns:1fr; gap:8px }
}

</style>
</head>
<body>
<div class="wrap">
  <div class="topbar">
    <h1>ì•”í˜¸í™”í ì˜¬ì¸ì› ê³„ì‚°ê¸°</h1>
    <div class="spacer"></div>
    <a class="btn tip-link" href="https://cafe.naver.com/bitupg" target="_blank" rel="noopener">ì´ˆë³´ì íŒ</a>
  </div>

  <p class="lead">ìˆ˜ìˆ˜ë£Œ/PNL/í‰ë‹¨/ì²­ì‚°ê°€ ê³„ì‚°ê¸°ì™€ ê±°ë˜ì†Œ í˜œíƒ ë¹„êµë¥¼ í•œ ë²ˆì—.</p>

  <div class="tabs" role="tablist" aria-label="íƒ­ ë„¤ë¹„ê²Œì´ì…˜">
    <button class="tab-btn active" data-tab="fee">ìˆ˜ìˆ˜ë£Œ</button>
    <button class="tab-btn" data-tab="pnl">ìˆ˜ìµë¥ /PNL</button>
    <button class="tab-btn" data-tab="avg">í‰ë‹¨ê°€</button>
    <button class="tab-btn" data-tab="liq">ì²­ì‚°ê°€</button>
  </div>

  <!-- ìˆ˜ìˆ˜ë£Œ -->
  <section id="panel-fee" class="tab-panel flexcol active" role="tabpanel">
    <div id="fee-config" class="card order-1">
      <h3 class="section-title">ê¸°ë³¸ ì„¤ì •</h3>
      <div class="row">
        <div>
          <label>ê±°ë˜ì†Œ</label>
          <select id="exchange">
            <option value="Bitget">Bitget</option>
            <option value="Bybit">Bybit</option>
            <option value="OKX">OKX</option>
            <option value="MEXC">MEXC</option>
            <option value="Binance">Binance</option>
            <option value="BingX">BingX</option>
          </select>
        </div>
        <div>
          <label>ë§ˆì¼“</label>
          <div class="seg"><button id="btn-spot" type="button">ìŠ¤íŒŸ</button><button id="btn-perp" type="button" class="active">ì„ ë¬¼(í¼í”„)</button></div>
        </div>
        <div>
          <label>ì£¼ë¬¸ ìœ í˜•</label>
          <div class="seg"><button id="btn-maker" type="button">ì§€ì •ê°€(Maker)</button><button id="btn-taker" type="button" class="active">ì‹œì¥ê°€(Taker)</button></div>
        </div>
      </div>

      <div class="col-3" style="margin-top:8px">
        <div class="card" style="margin:0">
          <h3 class="section-title">ì²´ê²°ê°€ì¹˜/íšŸìˆ˜</h3>
<div class="row"><div><label>ì²´ê²°ê°€ì¹˜ (USDT)</label><input id="notional" type="number" min="0" value="10000"/></div><div><label>ê±°ë˜ íšŸìˆ˜ (í•©ì‚°)</label><input id="trades" type="number" min="1" value="1"/></div><div><label>ë ˆë²„ë¦¬ì§€ (ë°°)</label><input id="fee-lev" type="number" min="1" max="200" step="1" value="10"/></div><div><label>ì‚¬ìš©ì í˜ì´ë°± (%)</label><input id="payback" type="number" step="0.1" min="0" max="100" value="0"/></div></div>
          <div class="small" style="margin-top:4px">â€» í˜ì´ë°±ì€ ìºì‹œë°±/í™˜ê¸‰í˜•ë§Œ ì…ë ¥ (ì—†ìœ¼ë©´ 0). ë ˆë²„ë¦¬ì§€ëŠ” í‘œì‹œìš©ì´ë©° ìˆ˜ìˆ˜ë£Œ ê³„ì‚°ì€ 'ì²´ê²°ê°€ì¹˜' ê¸°ì¤€ì…ë‹ˆë‹¤.</div>
        </div>

        <div class="card" style="margin:0">
          <h3 class="section-title">ìˆ˜ìˆ˜ë£Œìœ¨ ì§ì ‘ ì…ë ¥</h3>
          <div class="row">
            <div><label><b>ì§€ì •ê°€</b> ìˆ˜ìˆ˜ë£Œìœ¨ (%)</label><input id="rate-maker" type="number" step="0.0001" min="0" value="0.02"/></div>
            <div><label><b>ì‹œì¥ê°€</b> ìˆ˜ìˆ˜ë£Œìœ¨ (%)</label><input id="rate-taker" type="number" step="0.0001" min="0" value="0.06"/></div>
          </div>
          <div class="small" style="margin-top:4px">â€» ê³„ì‚°ì—” ìœ„ ë‘ ê°’ì´ ê·¸ëŒ€ë¡œ ì‚¬ìš©ë©ë‹ˆë‹¤. (ì£¼ë¬¸ ìœ í˜•ì— ë”°ë¼ ìë™ ì„ íƒ)</div>
        </div>

        <div class="card" style="margin:0">
          <h3 class="section-title">ì°¸ê³  ìˆ˜ìˆ˜ë£Œìœ¨</h3>
          <div class="ref-box">
            <div class="ref-grid">
              <div>
                <div class="small"><b>Spot</b></div>
                <div class="kv"><div class="k small"><b>ì§€ì •ê°€</b></div><div class="v" id="ref-spot-maker">-</div></div>
                <div class="kv"><div class="k small"><b>ì‹œì¥ê°€</b></div><div class="v" id="ref-spot-taker">-</div></div>
              </div>
              <div>
                <div class="small"><b>Futures</b></div>
                <div class="kv"><div class="k small"><b>ì§€ì •ê°€</b></div><div class="v" id="ref-perp-maker">-</div></div>
                <div class="kv"><div class="k small"><b>ì‹œì¥ê°€</b></div><div class="v" id="ref-perp-taker">-</div></div>
              </div>
            </div>
            <div class="actions-center">
              <button id="applyRef" class="btn" type="button">ì°¸ê³ ê°’ ì ìš©</button>
              <a id="refLink" class="btn" href="https://coinmarketcap.com/ko/rankings/exchanges/derivatives/" target="_blank" rel="noopener">ì½”ì¸ë§ˆì¼“ìº¡ ì—´ê¸°</a>
            </div>
            <div class="small">â€» ì°¸ê³ ì¹˜ì´ë©°, ì‹¤ì œ ìˆ˜ìˆ˜ë£ŒëŠ” ë“±ê¸‰/í”„ë¡œëª¨ì…˜/ë³´ìœ ì½”ì¸ ë“±ì— ë”°ë¼ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆì–´ìš”.</div>
          </div>
        </div>
      </div>
    </div>

    <div id="fee-results" class="card order-2">
      <h3 class="section-title">ê²°ê³¼</h3>
      <div class="result-box">
        <div class="kv"><div class="k">ì‚¬ìš© ìˆ˜ìˆ˜ë£Œìœ¨</div><div class="v" id="v-rate">-</div></div>
        <div class="kv"><div class="k">ì´ ìˆ˜ìˆ˜ë£Œ (1íšŒ)</div><div class="v" id="v-fee1">-</div></div>
        <div class="kv"><div class="k">ì´ ìˆ˜ìˆ˜ë£Œ (í•©ì‚°)</div><div class="v" id="v-feeN">-</div></div>
        <div class="hr"></div>
        <div class="kv"><div class="k">ì‚¬ìš©ì í˜ì´ë°±</div><div class="v" id="v-payback">-</div></div>
        <div class="kv"><div class="k">ì‚¬ìš©ì ì‹¤ë¶€ë‹´ ìˆ˜ìˆ˜ë£Œ</div><div class="v" id="v-net">-</div></div>
        <div class="kv"><div class="k">ì²´ê° ìˆ˜ìˆ˜ë£Œìœ¨(í‰ê· )</div><div class="v" id="v-eff">-</div></div>
      </div>
      <div class="actions-center">
        <a id="cta" class="cta-main" href="#" target="_blank" rel="noopener">ğŸ ìˆ˜ìˆ˜ë£Œ í˜œíƒ ë°›ê³  ê°€ì…í•˜ê¸°</a>
        <button id="benefitBtn" class="btn" type="button">í˜œíƒ ë³´ê¸°</button>
      </div>
    </div>
  </section>

  <!-- PNL -->
  <section id="panel-pnl" class="tab-panel" role="tabpanel">
    <div class="card">
      <h3 class="section-title">ìˆ˜ìµë¥  / PNL (í˜„ë¬¼Â·ì„ ë¬¼)</h3>
      <div class="row">
        <div><label>ëª¨ë“œ</label><div class="seg"><button id="pnl-mode-qty" type="button" class="active">ìˆ˜ëŸ‰ ì§ì ‘</button><button id="pnl-mode-margin" type="button">ì¦ê±°ê¸ˆÃ—ë ˆë²„ë¦¬ì§€</button></div></div>
      </div>
      <div class="row" id="pnl-row-qty" style="margin-top:8px">
        <div><label>ë§¤ìˆ˜ê°€</label><input id="pnl-entry" type="number" min="0" value="100"/></div>
        <div><label>ë§¤ë„ê°€</label><input id="pnl-exit" type="number" min="0" value="110"/></div>
        <div><label>ìˆ˜ëŸ‰</label><input id="pnl-qty" type="number" min="0" value="1"/></div>
      </div>
      <div class="row hidden" id="pnl-row-margin" style="margin-top:8px">
        <div><label>ë§¤ìˆ˜ê°€</label><input id="pnl-entry2" type="number" min="0" value="100"/></div>
        <div><label>ë§¤ë„ê°€</label><input id="pnl-exit2" type="number" min="0" value="110"/></div>
        <div><label>ì¦ê±°ê¸ˆ (USDT)</label><input id="pnl-margin" type="number" min="0" value="500"/></div>
        <div><label>ë ˆë²„ë¦¬ì§€ (ë°°)</label><input id="pnl-lev" type="number" min="1" max="200" step="1" value="10"/></div>
      </div>
    </div>
    <div class="card">
      <h3 class="section-title">PNL ê²°ê³¼</h3>
      <div class="result-box">
        <div class="kv"><div class="k">ì†ìµ (USDT)</div><div class="v" id="pnl-pnl">-</div></div>
        <div class="kv"><div class="k">ìˆ˜ìµë¥ </div><div class="v" id="pnl-roe">-</div></div>
        <div class="kv"><div class="k">ì¶”ì • ì²´ê²°ê°€ì¹˜</div><div class="v" id="pnl-notional">-</div></div>
      </div>
      <div class="small" style="margin-top:6px">â€» ì„ ë¬¼ ëª¨ë“œ: ìˆ˜ëŸ‰ = ì¦ê±°ê¸ˆÃ—ë ˆë²„ë¦¬ì§€ Ã· ë§¤ìˆ˜ê°€. ìˆ˜ìˆ˜ë£Œ/í€ë”©/ìŠ¬ë¦¬í”¼ì§€ ë¯¸í¬í•¨.</div>
    </div>
  </section>

  <!-- í‰ë‹¨ -->
  <section id="panel-avg" class="tab-panel" role="tabpanel">
    <div class="card">
      <h3 class="section-title">í‰ê·  ë§¤ì…ë‹¨ê°€ ê³„ì‚°</h3>
      <div class="row">
        <div><label>ë§¤ìˆ˜ê°€ A</label><input id="avg-a-price" type="number" min="0" value="100"/></div>
        <div><label>ìˆ˜ëŸ‰ A</label><input id="avg-a-qty" type="number" min="0" value="1"/></div>
      </div>
      <div class="row">
        <div><label>ë§¤ìˆ˜ê°€ B</label><input id="avg-b-price" type="number" min="0" value="120"/></div>
        <div><label>ìˆ˜ëŸ‰ B</label><input id="avg-b-qty" type="number" min="0" value="1"/></div>
      </div>
      <div class="row">
        <div><label>ë§¤ìˆ˜ê°€ C (ì„ íƒ)</label><input id="avg-c-price" type="number" min="0"/></div>
        <div><label>ìˆ˜ëŸ‰ C (ì„ íƒ)</label><input id="avg-c-qty" type="number" min="0"/></div>
      </div>
    </div>
    <div class="card">
      <h3 class="section-title">í‰ë‹¨ê°€ ê²°ê³¼</h3>
      <div class="result-box">
        <div class="kv"><div class="k">í‰ë‹¨ê°€</div><div class="v" id="avg-price">-</div></div>
        <div class="kv"><div class="k">ì´ ìˆ˜ëŸ‰</div><div class="v" id="avg-qty">-</div></div>
        <div class="kv"><div class="k">ì´ ë§¤ì…ê¸ˆì•¡</div><div class="v" id="avg-sum">-</div></div>
      </div>
    </div>
  </section>

  <!-- ì²­ì‚°ê°€ -->
  <section id="panel-liq" class="tab-panel" role="tabpanel">
    <div class="row" style="gap:16px">
      <div class="card" style="flex:1 1 560px">
        <div class="seg" style="max-width:360px; margin-bottom:12px">
          <button id="liq-long" type="button" class="active">ë¡± / Long</button>
          <button id="liq-short" type="button">ìˆ / Short</button>
        </div>
        <div style="margin:8px 0 6px; font-weight:800">ë ˆë²„ë¦¬ì§€: <span id="liq-levx">10</span>X</div>
        <input id="liq-lev-range" type="range" min="1" max="125" step="1" value="10" style="width:100%">
        <div class="row" style="margin-top:12px">
          <div><label>ì§„ì… ê°€ê²©</label><input id="liq-entry" type="number" min="0" value="100"/></div>
          <div><label>ë ˆë²„ë¦¬ì§€ (ë°°)</label><input id="liq-lev" type="text" inputmode="numeric" pattern="[0-9]*" value="10"/></div>
        </div>
        <div class="row" style="margin-top:10px">
          <div><label>í˜„ì¬/ì¢…ê°€</label><input id="liq-price" type="number" min="0" value="110"/></div>
          <div><label>ì¦ê±°ê¸ˆ (USDT, ì„ íƒ)</label><input id="liq-margin" type="number" min="0" placeholder="ì„ íƒ ì…ë ¥"/></div>
        </div>
        <div class="row" style="margin-top:10px">
          <div><label>ì²­ì‚° ê°€ê²© (ìë™)</label><input id="liq-base" type="text" value="-" readonly/></div>
          <div></div>
        </div>
      </div>
      <div class="card" style="flex:1 1 420px">
        <h3 class="section-title" style="margin-bottom:6px">ê²°ê³¼</h3>
        <div class="result-box">
          <div class="kv"><div class="k">ë ˆë²„ë¦¬ì§€</div><div class="v"><span id="r-levx">10</span>X</div></div>
          <div class="kv"><div class="k">ì§„ì… ê°€ê²©</div><div class="v" id="r-entry">-</div></div>
          <div class="kv"><div class="k">ì²­ì‚° ê°€ê²©</div><div class="v" id="r-liq">-</div></div>
          <div class="kv"><div class="k">ìˆ˜ëŸ‰</div><div class="v" id="r-qty">-</div></div>
          <div class="kv"><div class="k">ì´ˆê¸° ë§ˆì§„</div><div class="v" id="r-margin">-</div></div>
          <div class="kv"><div class="k">ì†ìµ</div><div class="v" id="r-pnl">-</div></div>
          <div class="kv"><div class="k">ìê¸°ìë³¸ ì´ìµë¥ </div><div class="v" id="r-roe">-</div></div>
        </div>
        <div class="small" style="margin-top:8px">â€» ê°„ë‹¨ ê·¼ì‚¬ì‹(ìˆ˜ìˆ˜ë£Œ/í€ë”© ì œì™¸). ë¡±: <code>EÃ—(1âˆ’1/L)</code>, ìˆ: <code>EÃ—(1+1/L)</code>. ì¦ê±°ê¸ˆ ì…ë ¥ ì‹œ ìˆ˜ëŸ‰ = <code>ì¦ê±°ê¸ˆÃ—ë ˆë²„ë¦¬ì§€ Ã· ì§„ì…ê°€</code>.</div>
      </div>
    </div>
  </section>

  <!-- ê±°ë˜ì†Œ ë°°ë„ˆ/í‘œ -->
  <div id="exchanges" class="card">
    <div style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px">
      <h3 class="section-title" style="margin:0">ê±°ë˜ì†Œ í˜œíƒ</h3>
      <button id="show-all-ex" class="btn" type="button">ë‹¤ë¥¸ ê±°ë˜ì†Œ ë³´ê¸°</button>
    </div>
    <div id="banners"></div>
  </div>

  <div class="card">
    <h3 class="section-title">ê±°ë˜ì†Œ ìˆ˜ìˆ˜ë£Œ ë¹„êµ Â· í•µì‹¬ ìš”ì•½</h3>
    <div style="overflow:auto">
      <table class="table">
        <thead><tr><th>ê±°ë˜ì†Œ</th><th>ì ìš© ì „ (ì§€ì •/ì‹œì¥)</th><th>ì ìš© í›„ (ì§€ì •/ì‹œì¥)</th><th>í˜ì´ë°±/í• ì¸</th><th>í˜œíƒ</th></tr></thead>
        <tbody id="cmp-body"></tbody>
      </table>
    </div>
  </div>
</div>

<!-- í•˜ë‹¨ ë„¤ë¹„ -->
<div class="mobile-dock" role="navigation" aria-label="ë¹ ë¥¸ ì´ë™">
  <button class="dock-btn" data-tab="fee">ìˆ˜ìˆ˜ë£Œ</button>
  <button class="dock-btn" data-tab="pnl">PNL</button>
  <button class="dock-btn" data-tab="avg">í‰ë‹¨</button>
  <button class="dock-btn" data-tab="liq">ì²­ì‚°ê°€</button>
</div>

<!-- í˜œíƒ ëª¨ë‹¬ -->
<div class="modal-backdrop" id="benefitBackdrop" aria-hidden="true">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="benefitTitle">
    <button id="benefitCloseX" class="modal-close-x" aria-label="ë‹«ê¸°">Ã—</button>
    <h3 id="benefitTitle">ê±°ë˜ì†Œ í˜œíƒ</h3>
    <div id="benefitChips" class="chips"></div>
    <ul id="benefitList" style="margin:8px 0 0;padding-left:18px;line-height:1.6;text-align:left"></ul>
    <div class="actions" style="display:flex;justify-content:center">
      <a class="modal-cta" id="benefitCTA" href="#" target="_blank" rel="noopener">ğŸ ìˆ˜ìˆ˜ë£Œ í˜œíƒ ë°›ê³  ê°€ì…í•˜ê¸°</a>
    </div>
  </div>
</div>

<script>
/* ìœ í‹¸ */
const $=s=>document.querySelector(s), $$=s=>document.querySelectorAll(s);
const nf=x=>(Math.round((+x||0)*1e8)/1e8).toLocaleString();
const toPerc=x=>((+x||0)*100).toFixed(6).replace(/0+$/,'').replace(/\.$/,'')+'%';
const animateNumber=(el,t,fmt=(x)=>x)=>{ if(!el) return; el.textContent=fmt(t); el.dataset.v=t; };
const toggle=(on,off)=>{ on?.classList.add('active'); off?.classList.remove('active'); };

/* íƒ­ + ë„í¬ */
(function setupTabs(){
  const btns=$$('.tab-btn'); const panels=$$('.tab-panel');
  function activate(tab){
    btns.forEach(b=>b.classList.toggle('active', b.dataset.tab===tab));
    panels.forEach(p=>p.classList.toggle('active', p.id==='panel-'+tab));
    document.querySelector('.topbar')?.scrollIntoView({behavior:'smooth', block:'start'});
  }
  btns.forEach(btn=>btn.addEventListener('click',()=>activate(btn.dataset.tab)));
  $$('.mobile-dock .dock-btn').forEach(d=>d.addEventListener('click',()=>activate(d.dataset.tab)));
})();

/* ìˆ˜ìˆ˜ë£Œ/ì°¸ê³ /í˜œíƒ ë°ì´í„° */
const REF = { Bitget:{spot:{maker:0.10,taker:0.10},perp:{maker:0.02,taker:0.06}}, Bybit:{spot:{maker:0.10,taker:0.10},perp:{maker:0.02,taker:0.055}}, OKX:{spot:{maker:0.10,taker:0.10},perp:{maker:0.02,taker:0.05}}, MEXC:{spot:{maker:0.10,taker:0.10},perp:{maker:0.00,taker:0.02}}, Binance:{spot:{maker:0.10,taker:0.10},perp:{maker:0.02,taker:0.04}}, BingX:{spot:{maker:0.10,taker:0.10},perp:{maker:0.02,taker:0.05}} };
const PROMOS = [
  { name:'Bitget',  logo:'https://logo.clearbit.com/bitget.com',  grad:['#22d3ee','#2563eb'], color:'#0ea5e9', before:{maker:0.02,taker:0.06},  after:{maker:0.016,taker:0.032}, payback:'ìˆ˜ìˆ˜ë£Œ í• ì¸ + í˜ì´ë°± 20%', benefits:['ìˆ˜ìˆ˜ë£Œ í• ì¸ + í˜ì´ë°± 20%','ì‹œì¥ê°€ ì‹¤ì§ˆ 0.04% ê°€ëŠ¥'], link:'https://partner.bitget.com/bg/Jihoon7' },
  { name:'Bybit',   logo:'https://logo.clearbit.com/bybit.com',  grad:['#f59e0b','#d97706'], color:'#d97706', before:{maker:0.02,taker:0.055}, after:{maker:0.016,taker:0.049}, payback:'í˜ì´ë°± 20%',         benefits:['ìˆ˜ìˆ˜ë£Œ í˜ì´ë°± 20%'], link:'https://partner.bybit.com/b/JIHOON' },
  { name:'OKX',     logo:'https://logo.clearbit.com/okx.com',    grad:['#111111','#000000'], color:'#0b0f19', before:{maker:0.02,taker:0.05},  after:{maker:0.016,taker:0.045}, payback:'í˜ì´ë°± 20%',         benefits:['ìˆ˜ìˆ˜ë£Œ í˜ì´ë°± 20%'], link:'https://www.okx.com/join/KANGJIHOON' },
  { name:'MEXC',    logo:'https://logo.clearbit.com/mexc.com',   grad:['#10b981','#059669'], color:'#10b981', before:{maker:0.0,taker:0.02},   after:{maker:0.0,taker:0.018},  payback:'í˜ì´ë°± 20%',         benefits:['ìˆ˜ìˆ˜ë£Œ í˜ì´ë°± 20%'], link:'https://www.mexc.com/ko-KR/acquisition/custom-sign-up?shareCode=mexc-Jihoon' },
  { name:'Binance', logo:'https://logo.clearbit.com/binance.com',grad:['#f59e0b','#f59e0b'], color:'#f0b90b', before:{maker:0.02,taker:0.04},  after:{maker:0.018,taker:0.038}, payback:'10% í• ì¸',         benefits:['ìˆ˜ìˆ˜ë£Œ 10% í• ì¸'], link:'https://accounts.binance.com/register?ref=ME5CYRHB' },
  { name:'BingX',   logo:'https://logo.clearbit.com/bingx.com',  grad:['#0ea5e9','#1d4ed8'], color:'#2563eb', before:{maker:0.02,taker:0.05},  after:{maker:0.011,taker:0.0275}, payback:'42~45% í˜ì´ë°±',   benefits:['ìˆ˜ìˆ˜ë£Œ í˜ì´ë°± 42~45%'], link:'https://bingx.com/invite/2N30XH/' },
];

/* ìˆ˜ìˆ˜ë£Œ ê³„ì‚° */
let state={exchange:'Bitget',market:'perp',order:'taker'};
const elExchange=$('#exchange'), elSpot=$('#btn-spot'), elPerp=$('#btn-perp');
const elMaker=$('#btn-maker'), elTaker=$('#btn-taker');
const elNotional=$('#notional'), elTrades=$('#trades'), elPayback=$('#payback');
const elRateMaker=$('#rate-maker'), elRateTaker=$('#rate-taker');
const vRate=$('#v-rate'), vFee1=$('#v-fee1'), vFeeN=$('#v-feeN'), vPB=$('#v-payback'), vNet=$('#v-net'), vEff=$('#v-eff');
const elCTA=$('#cta');
const refSpotM=$('#ref-spot-maker'), refSpotT=$('#ref-spot-taker');
const refPerpM=$('#ref-perp-maker'), refPerpT=$('#ref-perp-taker');
const refLink=$('#refLink'), btnApplyRef=$('#applyRef');
function refreshRef(){ const ex=state.exchange; const s=REF[ex]?.spot||{maker:0,taker:0}, p=REF[ex]?.perp||{maker:0,taker:0}; refSpotM.textContent=s.maker.toFixed(3)+'%'; refSpotT.textContent=s.taker.toFixed(3)+'%'; refPerpM.textContent=p.maker.toFixed(3)+'%'; refPerpT.textContent=p.taker.toFixed(3)+'%'; refLink.href="https://coinmarketcap.com/ko/rankings/exchanges/derivatives/"; }
btnApplyRef?.addEventListener('click',()=>{ const src=REF[state.exchange]?.[state.market]; if(!src) return; elRateMaker.value=src.maker; elRateTaker.value=src.taker; updateFee(); });
function applyExchangeTheme(name){ const p=PROMOS.find(x=>x.name===name); if(!p) return; elCTA.style.background=`linear-gradient(90deg,${p.grad[0]},${p.grad[1]})`; elCTA.href=p.link; }
function currentRate(){ const maker=(+elRateMaker.value||0)/100; const taker=(+elRateTaker.value||0)/100; return state.order==='maker' ? maker : taker; }
function updateFee(){ const rate=currentRate(); const N=+elNotional.value||0; const t=Math.max(1,+elTrades.value||1); const pbRate=(+elPayback.value||0)/100; const fee1=N*rate, feeN=fee1*t, pb=feeN*pbRate, net=feeN-pb, eff=N>0?net/(N*t):0; animateNumber(vRate, rate, toPerc); animateNumber(vFee1, fee1, x=>nf(x)+' USDT'); animateNumber(vFeeN, feeN, x=>nf(x)+' USDT'); animateNumber(vPB, pb, x=>nf(x)+' USDT'); animateNumber(vNet, net, x=>nf(x)+' USDT'); animateNumber(vEff, eff, toPerc); }

elExchange?.addEventListener('change',()=>{ state.exchange=elExchange.value; refreshRef(); applyExchangeTheme(state.exchange); });
elSpot?.addEventListener('click',()=>{ state.market='spot'; toggle(elSpot,elPerp); refreshRef(); });
elPerp?.addEventListener('click',()=>{ state.market='perp'; toggle(elPerp,elSpot); refreshRef(); });
elMaker?.addEventListener('click',()=>{ state.order='maker'; toggle(elMaker,elTaker); updateFee(); });
elTaker?.addEventListener('click',()=>{ state.order='taker'; toggle(elTaker,elMaker); updateFee(); });
[elNotional,elTrades,elPayback,elRateMaker,elRateTaker].forEach(el=>el?.addEventListener('input',updateFee));

/* PNL */
const pnlQty=$('#pnl-row-qty'), pnlMargin=$('#pnl-row-margin');
const btnQty=$('#pnl-mode-qty'), btnMargin=$('#pnl-mode-margin');
const pnl_el={pnl:$('#pnl-pnl'),roe:$('#pnl-roe'),notional:$('#pnl-notional')};
function setPnlMode(m){ if(m==='qty'){ btnQty.classList.add('active'); btnMargin.classList.remove('active'); pnlQty.classList.remove('hidden'); pnlMargin.classList.add('hidden'); } else { btnMargin.classList.add('active'); btnQty.classList.remove('active'); pnlMargin.classList.remove('hidden'); pnlQty.classList.add('hidden'); } calcPNL(); }
btnQty?.addEventListener('click',()=>setPnlMode('qty')); btnMargin?.addEventListener('click',()=>setPnlMode('margin'));
;['pnl-entry','pnl-exit','pnl-qty','pnl-entry2','pnl-exit2','pnl-margin','pnl-lev'].forEach(id=>document.getElementById(id)?.addEventListener('input',calcPNL));
function nf2(x){return (Math.round(x*1e8)/1e8).toLocaleString();}
function calcPNL(){ if(pnlMargin.classList.contains('hidden')){ const entry=+( document.getElementById('pnl-entry').value||0 ), exit=+( document.getElementById('pnl-exit').value||0 ), qty=+( document.getElementById('pnl-qty').value||0 ); const pnl=(exit-entry)*qty; const notional=entry*qty; const roe=notional>0?pnl/notional:0; pnl_el.pnl.textContent=nf2(pnl)+' USDT'; pnl_el.roe.textContent=toPerc(roe); pnl_el.notional.textContent=nf2(notional)+' USDT'; return; } const entry=+( document.getElementById('pnl-entry2').value||0 ), exit=+( document.getElementById('pnl-exit2').value||0 ), m=+( document.getElementById('pnl-margin').value||0 ), lv=Math.max(1,+( document.getElementById('pnl-lev').value||1 )); const notional=entry>0?m*lv:0; const qty=entry>0?(m*lv)/entry:0; const pnl=(exit-entry)*qty; const roe=m>0?pnl/m:0; pnl_el.pnl.textContent=nf2(pnl)+' USDT'; pnl_el.roe.textContent=toPerc(roe); pnl_el.notional.textContent=nf2(notional)+' USDT'; }

/* ì²­ì‚°ê°€ ê³„ì‚° (+/-, range, ì…ë ¥ ëª¨ë‘ ë°˜ì‘) */
let liqSide = 'long';
const L = {
  longBtn: document.getElementById('liq-long'),
  shortBtn: document.getElementById('liq-short'),
  entry: document.getElementById('liq-entry'),
  lev: document.getElementById('liq-lev'),
  levRange: document.getElementById('liq-lev-range'),
  levx: document.getElementById('liq-levx'),
  base: document.getElementById('liq-base'),
  price: document.getElementById('liq-price'),
  margin: document.getElementById('liq-margin'),
  r_levx: document.getElementById('r-levx'),
  r_entry: document.getElementById('r-entry'),
  r_liq: document.getElementById('r-liq'),
  r_qty: document.getElementById('r-qty'),
  r_margin: document.getElementById('r-margin'),
  r_pnl: document.getElementById('r-pnl'),
  r_roe: document.getElementById('r-roe'),
};
function fmtNum(x){ return (Math.round((+x||0)*1e8)/1e8).toLocaleString(); }
function calcLiq(){
  const entry = +(L.entry?.value||0);
  const lev = Math.max(1, +(L.lev?.value||1));
  if (L.levx) L.levx.textContent = lev;
  if (L.r_levx) L.r_levx.textContent = lev;
  if (entry<=0){
    if (L.base) L.base.value='-';
    if (L.r_entry) L.r_entry.textContent='-';
    if (L.r_liq) L.r_liq.textContent='-';
    if (L.r_qty) L.r_qty.textContent='-';
    if (L.r_margin) L.r_margin.textContent='-';
    if (L.r_pnl) L.r_pnl.textContent='-';
    if (L.r_roe) L.r_roe.textContent='-';
    return;
  }
  const liq = liqSide==='long' ? entry*(1-1/lev) : entry*(1+1/lev);
  if (L.base) L.base.value = fmtNum(liq);
  if (L.r_entry) L.r_entry.textContent = fmtNum(entry) + ' USDT';
  if (L.r_liq) L.r_liq.textContent = fmtNum(liq) + ' USDT';

  const m = +(L.margin?.value||0);
  if (m>0){
    const qty=(m*lev)/entry;
    if (L.r_qty) L.r_qty.textContent=fmtNum(qty);
    if (L.r_margin) L.r_margin.textContent=fmtNum(m)+' USDT';
  } else {
    if (L.r_qty) L.r_qty.textContent='-';
    if (L.r_margin) L.r_margin.textContent='-';
  }

  const px = +(L.price?.value||0);
  if (px>0 && m>0){
    const qty2=(m*lev)/entry;
    const dir = (liqSide==='long') ? 1 : -1;
    const pnl = dir * (px - entry) * qty2;
    const roe = (pnl / m) * 100;
    if (L.r_pnl) L.r_pnl.textContent = fmtNum(pnl)+' USDT';
    if (L.r_roe) L.r_roe.textContent = (Math.round(roe*100)/100).toLocaleString()+'%';
  } else {
    if (L.r_pnl) L.r_pnl.textContent='-';
    if (L.r_roe) L.r_roe.textContent='-';
  }
}
function clampLev(){ const v=Math.max(1, Math.min(125, +(L.lev?.value||1))); if(L.lev) L.lev.value=v; if(L.levRange) L.levRange.value=v; calcLiq(); }
L.levRange?.addEventListener('input', ()=>{ if(L.lev) L.lev.value=L.levRange.value; calcLiq(); });
L.lev?.addEventListener('input', ()=>{   const val = L.lev.value;   if(val === '' || !/^[0-9]+$/.test(val)) return;   if (L.levRange) L.levRange.value = val;   calcLiq(); }); L.lev?.addEventListener('change', ()=>{ clampLev(); });
document.getElementById('liq-lev-dec')?.addEventListener('click', ()=>{ if(!L.lev) return; L.lev.value = Math.max(1, (+L.lev.value||1)-1); clampLev(); });
document.getElementById('liq-lev-inc')?.addEventListener('click', ()=>{ if(!L.lev) return; L.lev.value = Math.min(125, (+L.lev.value||1)+1); clampLev(); });
L.longBtn?.addEventListener('click', ()=>{ liqSide='long'; L.longBtn.classList.add('active'); L.shortBtn?.classList.remove('active'); calcLiq(); });
L.shortBtn?.addEventListener('click', ()=>{ liqSide='short'; L.shortBtn.classList.add('active'); L.longBtn?.classList.remove('active'); calcLiq(); });
['liq-entry','liq-margin','liq-price'].forEach(id=> document.getElementById(id)?.addEventListener('input', calcLiq));

/* ê±°ë˜ì†Œ ë°°ë„ˆ/í‘œ ë Œë” */
let extraRendered=false;
function renderExchanges(initialOnly=true){
  const banners=document.getElementById('banners');
  const body=document.getElementById('cmp-body');
  banners.innerHTML=''; body.innerHTML='';
  const list = initialOnly? PROMOS.filter(p=>p.name==='Bitget') : PROMOS;
  list.forEach(p=>{
    const el=document.createElement('div');
    el.className=`banner ex-${p.name}`;
    el.style.background=`linear-gradient(90deg,${p.grad[0]},${p.grad[1]})`;
    el.innerHTML=`
      <div class="banner-header">
        <img src="${p.logo}" alt="${p.name}">
        <div>
          <h3>${p.name} ìˆ˜ìˆ˜ë£Œ/í˜œíƒ</h3>
          <p>
            <span class="badge">ì ìš© ì „: ${p.before.maker}%/${p.before.taker}%</span>
            <span class="badge">ì ìš© í›„: ${p.after.maker}%/${p.after.taker}%</span>
            <span class="badge">${p.payback}</span>
          </p>
        </div>
      </div>
      <div class="cta-row">
        <a class="cta-white" style="color:${p.color}" href="${p.link}" target="_blank" rel="noopener">ğŸ ìˆ˜ìˆ˜ë£Œ í˜œíƒ ë°›ê³  ê°€ì…í•˜ê¸°</a>
        <button class="btn banner-benefit" data-benefit="${p.name}" type="button">í˜œíƒ ë³´ê¸°</button>
      </div>`;
    banners.appendChild(el);

    const tr=document.createElement('tr');
    tr.innerHTML=`
      <td style="font-weight:900">${p.name}</td>
      <td>${p.before.maker}% / ${p.before.taker}%</td>
      <td>${p.after.maker}% / ${p.after.taker}%</td>
      <td><span class="pill">${p.payback}</span></td>
      <td>
        <div style="display:flex; gap:6px; flex-wrap:wrap">
          <a class="btn" href="${p.link}" target="_blank" rel="noopener">ğŸ ê°€ì…í•˜ê¸°</a>
          <button class="btn table-benefit" data-benefit="${p.name}" type="button">í˜œíƒ ë³´ê¸°</button>
        </div>
      </td>`;
    body.appendChild(tr);
  });
}
document.getElementById('show-all-ex')?.addEventListener('click',()=>{
  if(!extraRendered){ renderExchanges(false); extraRendered=true; document.getElementById('show-all-ex').textContent='ì ‘ê¸°'; }
  else{ renderExchanges(true); extraRendered=false; document.getElementById('show-all-ex').textContent='ë‹¤ë¥¸ ê±°ë˜ì†Œ ë³´ê¸°'; }
});
document.addEventListener('click',(e)=>{
  const b=e.target.closest('.banner-benefit, .table-benefit');
  if(!b) return;
  openBenefit(b.dataset.benefit);
});

/* í˜œíƒ ëª¨ë‹¬ */
const backdrop=document.getElementById('benefitBackdrop'), benefitTitle=document.getElementById('benefitTitle');
const benefitList=document.getElementById('benefitList'), benefitCTA=document.getElementById('benefitCTA');
document.getElementById('benefitBtn')?.addEventListener('click',()=>openBenefit(state.exchange));
document.getElementById('benefitCloseX')?.addEventListener('click',()=>backdrop.style.display='none');
backdrop?.addEventListener('click',(e)=>{ if(e.target===backdrop) backdrop.style.display='none'; });
function openBenefit(name){
  const p=PROMOS.find(x=>x.name===name); if(!p) return;
  benefitTitle.textContent=`${p.name} í˜œíƒ`;
  const chips=document.getElementById('benefitChips'); chips.innerHTML='';
  const chip=(t)=>{ const s=document.createElement('span'); s.className='chip'; s.textContent=t; return s; };
  chips.appendChild(chip(`ì ìš© ì „ ${p.before.maker}% / ${p.before.taker}%`));
  chips.appendChild(chip(`ì ìš© í›„ ${p.after.maker}% / ${p.after.taker}%`));
  if(p.payback) chips.appendChild(chip(p.payback));
  benefitList.innerHTML='';
  p.benefits.forEach(b=>{ const li=document.createElement('li'); li.textContent=b; benefitList.appendChild(li); });
  benefitCTA.href=p.link;
  benefitCTA.style.background=`linear-gradient(90deg,${p.grad[0]},${p.grad[1]})`;
  benefitCTA.textContent='ğŸ ìˆ˜ìˆ˜ë£Œ í˜œíƒ ë°›ê³  ê°€ì…í•˜ê¸°';
  backdrop.style.display='flex';
}


/* ===== í‰ë‹¨ê°€ ê³„ì‚° ===== */
function calcAvg(){
  const aP = +(document.getElementById('avg-a-price')?.value || 0);
  const aQ = +(document.getElementById('avg-a-qty')?.value || 0);
  const bP = +(document.getElementById('avg-b-price')?.value || 0);
  const bQ = +(document.getElementById('avg-b-qty')?.value || 0);
  const cP = +(document.getElementById('avg-c-price')?.value || 0);
  const cQ = +(document.getElementById('avg-c-qty')?.value || 0);
  const sum = aP*aQ + bP*bQ + (cP>0 && cQ>0 ? cP*cQ : 0);
  const qty = aQ + bQ + (cP>0 && cQ>0 ? cQ : 0);
  const avg = qty>0 ? sum/qty : 0;
  const vPrice = document.getElementById('avg-price');
  const vQty   = document.getElementById('avg-qty');
  const vSum   = document.getElementById('avg-sum');
  if(vPrice) vPrice.textContent = (Math.round(avg*1e8)/1e8).toLocaleString();
  if(vQty)   vQty.textContent   = (Math.round(qty*1e8)/1e8).toLocaleString();
  if(vSum)   vSum.textContent   = (Math.round(sum*1e8)/1e8).toLocaleString() + ' USDT';
}
;['avg-a-price','avg-a-qty','avg-b-price','avg-b-qty','avg-c-price','avg-c-qty'].forEach(id=>{
  const el = document.getElementById(id);
  if(el) el.addEventListener('input', calcAvg);
});

/* ì´ˆê¸°í™” */
(function boot(){ renderExchanges(true); refreshRef(); applyExchangeTheme(state.exchange); updateFee(); calcPNL(); clampLev(); calcLiq();  calcAvg();})();
</script>
</body>
</html>
